function InvokeCommand {

    # InvokeCommand user password computerName command

    $userName = $args[0]
    $securePwd = $args[1]
    
    $securePwd = $securePwd | ConvertTo-SecureString -AsPlainText -Force
    $credObject = New-Object System.Management.Automation.PSCredential($userName, $securePwd)
    
    $credObject;
    
    Invoke-Command  -ComputerName $args[2] -Credential $credObject -ScriptBlock {$args[3]}

}
